window.$=function(a){return document.getElementById(a)};var g=10,h=30,j=10,k=5,l="yellow",m="#FFFF66",n="",o="#FAF0E6",p={left:0,right:0},q=!1,r="leftstart",s="rightstart",t;function u(a){obj=document.getElementById(a);var b=a=0;if(obj&&obj.offsetParent){a=obj.offsetLeft;for(b=obj.offsetTop;obj=obj.offsetParent;)a+=obj.offsetLeft,b+=obj.offsetTop}return{x:a,y:b}}function v(a,b,d){var f=a.scrollTop,c=a.scrollLeft;a.scrollTop+=d;a.scrollLeft+=b;c=a.scrollLeft-c;f=a.scrollTop-f;return Math.abs(b)>k&&c===0||Math.abs(d)>k&&f===0?(a.style.backgroundColor=o,!0):(p[a.id]+=1,a.style.backgroundColor=n,!1)}function w(a){for(;a&&a.tagName!=="DIV";)a=a.parentElement||a.parentNode;return a}function x(a,b,d){q=!0;var f=w(document.getElementById(a)),c=w(document.getElementById(b)),e=u(a).y-f.scrollTop,e=u(b).y-c.scrollTop-e,f=f.scrollLeft-c.scrollLeft;if(e===0&&f===0)clearTimeout(t),q=!1;else if(d<=1)v(c,f,e),q=!1;else{d=Math.floor(Math.abs(e)/d);actualMinStep=Math.min(g,Math.abs(e));var d=Math.abs(d)<g?actualMinStep*(e>0?1:e<0?-1:0):d*(e>0?1:e<0?-1:0),c=v(c,f,d),E=Math.floor(e/d)-1;c?(clearTimeout(t),q=!1):t=setTimeout(function(){return x(a,b,E)},j)}}var y=[];function z(a,b){var d=document.getElementById(a);if(d!==null)d.style.backgroundColor=b,b!==n&&y.push(a)}function A(a){a=a||window.event;return a.target||a.srcElement}var B=["deletion","insertion","change","move","move-change","unchanged"],C=["deleted","inserted","change","same","same","same"];function D(a){if(typeof a==="string")this.appendChild(document.createTextNode(a));else if(typeof a==="object")if(a.i){var b=document.createElement("a");b.setAttribute("tid",a.i);b.setAttribute("class",B[a.c]);b.setAttribute("id",a.i+1);b.setAttribute("title",C[a.c]);b.innerHTML=a.s;this.appendChild(b);b.onclick=function(a){var a=A(a),b=a.id,c=a.getAttribute("tid");w(a).id==="left"?(r=b,s=c):(r=c,s=b);for(i=0;i<y.length;i+=1)z(y[i],n);y=[];z(b,l);z(c,l);z("ignore",m);z("ignore",m);x(b,c,h)}}else b=document.createElement("span"),b.setAttribute("class",B[a.c]),b.setAttribute("title",C[a.c]),b.innerHTML=a.s,this.appendChild(b);else throw"render data type err";}window.onload=function(){var a=JSON.parse($("data").innerText);a.left.forEach(D,$("leftstart").parentNode);a.right.forEach(D,$("rightstart").parentNode);[$("left"),$("right")].forEach(function(a){a.onscroll=function(a){a=A(a);a.style.backgroundColor=n;!q&&p[a.id]===0&&(a.id==="left"?x(r,s,1):x(s,r,1));p[a.id]>0&&(p[a.id]-=1)}})};